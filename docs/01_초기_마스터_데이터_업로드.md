# ì´ˆê¸° ë§ˆìŠ¤í„° ë°ì´í„° S3 ì—…ë¡œë“œ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

Rolling Window ì‹œìŠ¤í…œì„ ì •ìƒ ì‘ë™ì‹œí‚¤ê¸° ìœ„í•´ ê¸°ì¡´ ë§ˆìŠ¤í„° ë°ì´í„°ì…‹ì„ S3ì— ìˆ˜ë™ìœ¼ë¡œ ì—…ë¡œë“œí•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ¯ ëª©ì 

- **Rolling Window ì‹œìŠ¤í…œ í™œì„±í™”**: 21ê°œì›” ë°ì´í„° ë³´ì¡´ ë° ìë™ ì—…ë°ì´íŠ¸
- **í•™ìŠµìš© ë§ˆìŠ¤í„° ë°ì´í„° ì œê³µ**: ëª¨ë¸ í•™ìŠµì„ ìœ„í•œ í†µí•© ë°ì´í„°ì…‹
- **Airflow íŒŒì´í”„ë¼ì¸ ì—°ë™**: 1ì‹œê°„ë§ˆë‹¤ ìë™ ë°ì´í„° ì—…ë°ì´íŠ¸ ì¤€ë¹„

## ğŸ“‚ ì—…ë¡œë“œí•  íŒŒì¼

### íŒŒì¼ ì •ë³´
- **íŒŒì¼ëª…**: `weather_pm10_integrated_full.csv`
- **ìœ„ì¹˜**: í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬
- **ë‚´ìš©**: ê¸°ì¡´ 21ê°œì›”ì¹˜ ê¸°ìƒ + PM10 í†µí•© ë°ì´í„°
- **ìš©ë„**: Rolling Window ì‹œìŠ¤í…œì˜ ê¸°ì¤€ì 

### ë°ì´í„° êµ¬ì¡°
```csv
datetime,STN,temperature,pm10,...
2024-01-01 00:00:00,108,12.5,45.2,...
2024-01-01 01:00:00,108,12.8,43.1,...
...
```

## ğŸ—‚ï¸ S3 ì—…ë¡œë“œ ìœ„ì¹˜

### ì •í™•í•œ S3 ê²½ë¡œ
```
s3://{your-bucket-name}/weather_pm10_integrated_full.csv
```

### S3 ë²„í‚· êµ¬ì¡°
```
s3://your-bucket/
â”œâ”€â”€ weather_pm10_integrated_full.csv          â† ğŸ¯ ì—¬ê¸°ì— ì—…ë¡œë“œ
â”œâ”€â”€ raw/
â”‚   â”œâ”€â”€ asos/
â”‚   â”‚   â””â”€â”€ year=YYYY/month=MM/day=DD/
â”‚   â””â”€â”€ pm10/
â”‚       â””â”€â”€ year=YYYY/month=MM/day=DD/
â”œâ”€â”€ processed/
â”‚   â”œâ”€â”€ asos/
â”‚   â”‚   â””â”€â”€ year=YYYY/month=MM/day=DD/
â”‚   â””â”€â”€ pm10/
â”‚       â””â”€â”€ year=YYYY/month=MM/day=DD/
â””â”€â”€ ml_dataset/
    â””â”€â”€ year=YYYY/month=MM/day=DD/
        â”œâ”€â”€ dataset_HHMMSS.parquet                    # ì‹¤ì‹œê°„ ì¶”ë¡ ìš©
        â””â”€â”€ dataset_HHMMSS_training_master.parquet    # í•™ìŠµìš© ë§ˆìŠ¤í„°
```

## ğŸš€ ì—…ë¡œë“œ ë°©ë²•

### 1. AWS S3 Console ì‚¬ìš©
1. AWS S3 ì½˜ì†” ì ‘ì†
2. í•´ë‹¹ ë²„í‚· ì„ íƒ
3. **ë£¨íŠ¸ í´ë”**ì— `weather_pm10_integrated_full.csv` ì—…ë¡œë“œ
4. íŒŒì¼ëª…ì´ ì •í™•í•œì§€ í™•ì¸

### 2. AWS CLI ì‚¬ìš©
```bash
aws s3 cp weather_pm10_integrated_full.csv s3://your-bucket-name/weather_pm10_integrated_full.csv
```

### 3. LocalStack í™˜ê²½ (ê°œë°œìš©)
```bash
aws --endpoint-url=http://localhost:4566 s3 cp weather_pm10_integrated_full.csv s3://your-bucket-name/weather_pm10_integrated_full.csv
```

## âœ… ì—…ë¡œë“œ ê²€ì¦

### 1. íŒŒì¼ ì¡´ì¬ í™•ì¸
```bash
# AWS S3
aws s3 ls s3://your-bucket-name/weather_pm10_integrated_full.csv

# LocalStack
aws --endpoint-url=http://localhost:4566 s3 ls s3://your-bucket-name/weather_pm10_integrated_full.csv
```

### 2. íŒŒì¼ í¬ê¸° í™•ì¸
- ì—…ë¡œë“œëœ íŒŒì¼ í¬ê¸°ê°€ ë¡œì»¬ íŒŒì¼ê³¼ ë™ì¼í•œì§€ í™•ì¸
- CSV íŒŒì¼ì´ë¯€ë¡œ ì••ì¶•ë˜ì§€ ì•Šì€ ì›ë³¸ í¬ê¸°ì—¬ì•¼ í•¨

## ğŸ”„ ì—…ë¡œë“œ í›„ ë™ì‘

### ìë™ ì‹œìŠ¤í…œ í™œì„±í™”
ì—…ë¡œë“œ ì™„ë£Œ í›„ ë‹¤ìŒ Airflow ì‹¤í–‰ ì‹œ:

1. **ê¸°ì¡´ ë°ì´í„° ë¡œë“œ**: S3ì—ì„œ ë§ˆìŠ¤í„° íŒŒì¼ ë‹¤ìš´ë¡œë“œ
2. **ìƒˆ ë°ì´í„° ë³‘í•©**: ì‹¤ì‹œê°„ ìˆ˜ì§‘ ë°ì´í„°ì™€ í†µí•©
3. **Rolling Window ì ìš©**: 21ê°œì›”(630ì¼) ì´ì „ ë°ì´í„° ì‚­ì œ
4. **ì¤‘ë³µ ì œê±°**: datetime + station_id ê¸°ì¤€ ì •ë¦¬
5. **S3 ì¬ì—…ë¡œë“œ**: ì—…ë°ì´íŠ¸ëœ ë§ˆìŠ¤í„° íŒŒì¼ ì €ì¥
6. **ML ë°ì´í„°ì…‹ ìƒì„±**: í•™ìŠµìš© ë°ì´í„°ì…‹ ìë™ ìƒì„±

### Rolling Window ë™ì‘ ì˜ˆì‹œ
```
ì—…ë¡œë“œ ì‹œì  ë°ì´í„°: 2023-01-01 ~ 2025-09-26
ì²« ì‹¤í–‰ (2025-09-26): 2024-01-05 ì´í›„ ë°ì´í„°ë§Œ ìœ ì§€
ë‹¤ìŒ ì‹¤í–‰ (2025-09-26): 2024-01-05 ì´í›„ ë°ì´í„° + ìƒˆ ë°ì´í„°
...
ì§€ì†ì ìœ¼ë¡œ 21ê°œì›”ì¹˜ë§Œ ìœ ì§€
```

## ğŸ“Š ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ

### ê´€ë ¨ ì½”ë“œ íŒŒì¼
| íŒŒì¼ | ì—­í•  | ê´€ë ¨ ë©”ì„œë“œ |
|------|------|-------------|
| `src/data/weather_processor.py` | Rolling Window ë¡œì§ | `update_master_training_dataset()` |
| `src/storage/s3_client.py` | S3 ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ | `save_csv_to_s3()`, `load_csv_from_s3()` |

### í•„ìˆ˜ ë©”ì„œë“œ
```python
# S3ì—ì„œ CSV ë¡œë“œ
weather_handler.load_csv_from_s3("weather_pm10_integrated_full.csv")

# S3ì— CSV ì €ì¥
weather_handler.save_csv_to_s3(df, "weather_pm10_integrated_full.csv")
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### íŒŒì¼ëª… ì •í™•ì„±
- **ì •í™•í•œ íŒŒì¼ëª…**: `weather_pm10_integrated_full.csv`
- **ëŒ€ì†Œë¬¸ì êµ¬ë¶„**: íŒŒì¼ëª… ëŒ€ì†Œë¬¸ìê°€ ì •í™•í•´ì•¼ í•¨
- **í™•ì¥ì í•„ìˆ˜**: `.csv` í™•ì¥ì ë°˜ë“œì‹œ í¬í•¨

### ì—…ë¡œë“œ ìœ„ì¹˜
- **ë£¨íŠ¸ í´ë”**: ë²„í‚·ì˜ ë£¨íŠ¸ì— ì§ì ‘ ì—…ë¡œë“œ (í´ë” ì•ˆì— ë„£ì§€ ë§ ê²ƒ)
- **ê²½ë¡œ í™•ì¸**: `s3://bucket-name/weather_pm10_integrated_full.csv`
- **í•˜ìœ„ í´ë” ê¸ˆì§€**: `s3://bucket-name/data/weather_pm10_integrated_full.csv` âŒ

### ë°ì´í„° ë¬´ê²°ì„±
- **ì›ë³¸ ë³´ì¡´**: ë¡œì»¬ íŒŒì¼ì€ ë°±ì—…ìœ¼ë¡œ ë³´ê´€
- **ì¸ì½”ë”© í™•ì¸**: UTF-8 ì¸ì½”ë”© ìœ ì§€
- **ì»¬ëŸ¼ êµ¬ì¡°**: ê¸°ì¡´ ë°ì´í„° ìŠ¤í‚¤ë§ˆì™€ ì¼ì¹˜ í™•ì¸

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì¼ë°˜ì ì¸ ì˜¤ë¥˜

#### 1. íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
Error: NoSuchKey: The specified key does not exist
```
**í•´ê²°**: íŒŒì¼ëª…ê³¼ ì—…ë¡œë“œ ìœ„ì¹˜ ì¬í™•ì¸

#### 2. ê¶Œí•œ ì˜¤ë¥˜
```
Error: AccessDenied: Access Denied
```
**í•´ê²°**: S3 ë²„í‚· ì“°ê¸° ê¶Œí•œ í™•ì¸

#### 3. ì¸ì½”ë”© ì˜¤ë¥˜
```
Error: UnicodeDecodeError
```
**í•´ê²°**: CSV íŒŒì¼ì„ UTF-8ë¡œ ë‹¤ì‹œ ì €ì¥

### ê²€ì¦ ëª…ë ¹ì–´
```bash
# íŒŒì¼ ì¡´ì¬ í™•ì¸
aws s3 ls s3://your-bucket-name/ | grep weather_pm10

# íŒŒì¼ ë‚´ìš© ë¯¸ë¦¬ë³´ê¸° (ì²˜ìŒ 10ì¤„)
aws s3 cp s3://your-bucket-name/weather_pm10_integrated_full.csv - | head -10
```

## ğŸ‰ ì™„ë£Œ í™•ì¸

ì—…ë¡œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ë©´:

1. **âœ… S3ì— íŒŒì¼ ì¡´ì¬**: ë²„í‚· ë£¨íŠ¸ì— CSV íŒŒì¼ í™•ì¸
2. **âœ… Rolling Window ì¤€ë¹„**: ë‹¤ìŒ Airflow ì‹¤í–‰ ì‹œ ìë™ ì‘ë™
3. **âœ… ì‹œìŠ¤í…œ í†µí•©**: ì‹¤ì‹œê°„ ë°ì´í„°ì™€ ë§ˆìŠ¤í„° ë°ì´í„° ì—°ë™
4. **âœ… ML íŒŒì´í”„ë¼ì¸**: í•™ìŠµìš© ë°ì´í„°ì…‹ ìë™ ìƒì„±

## ğŸ“ ë¬¸ì˜ì‚¬í•­

### ì—…ë¡œë“œ ê´€ë ¨
- íŒŒì¼ì´ ë„ˆë¬´ í° ê²½ìš°: ì²­í¬ ì—…ë¡œë“œ ë˜ëŠ” ì••ì¶• ê³ ë ¤
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ì¬ì‹œë„ ë˜ëŠ” ë‹¤ë¥¸ ì—…ë¡œë“œ ë°©ë²• ì‹œë„

### ì‹œìŠ¤í…œ ê´€ë ¨
- Rolling Window ë™ì‘ í™•ì¸: Airflow ë¡œê·¸ ëª¨ë‹ˆí„°ë§
- ë°ì´í„° ì •í•©ì„±: ì—…ë¡œë“œ í›„ ì²« ì‹¤í–‰ ê²°ê³¼ ê²€ì¦

---

**ì‘ì„±ì¼**: 2025-09-26
**ìš©ë„**: Rolling Window ì‹œìŠ¤í…œ ì´ˆê¸° ì„¤ì •
**ë‹¤ìŒ ë‹¨ê³„**: ì—…ë¡œë“œ ì™„ë£Œ í›„ Airflow ì‹¤í–‰ ëª¨ë‹ˆí„°ë§